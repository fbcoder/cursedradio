#
# Python code for the interface
#

import curses
import time
import threading

class NCursesInterface(threading.Thread):
    def __init__ (self, mediator):
        threading.Thread.__init__(self)
        self.mediator = mediator
        self.currentTitle = ""
        self.currentArtist = ""
        self.radioState = "No station playing"
        self.screen = None
        #print "gaat curseswrapper aanroepen"        

    def wrapperCallback(self, screen):
        #print "curseswrapper aangeroepen"
        self.screen = screen
    
    def run(self):
        curses.wrapper(self.wrapperCallback)
        self.screen.nodelay(yes)
        self.drawInterface()
        i = ''
        while i != 'q':
            i = curses.unctrl(self.screen.getch(3,1))
    
    def printLine(self,x,y,text):
        self.screen.addstr(y,x,text)
    
    def drawInterface(self):
        self.screen.erase()
        self.printLine(10,1,"Artist: %s" % self.currentArtist)
        self.printLine(10,2,"Title: %s" % self.currentTitle)

    def updateVolume(self):
        pass

    def updateState(self, data):
        self.radioState = data['state']

    def updateSong(self, data):
        self.currentSong = self.mediator.context.data['title']
        self.currentArtist = self.mediator.context.data['artist']
        self.drawInterface